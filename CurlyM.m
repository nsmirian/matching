function CM = CurlyM(M)

Mx = M(1:2,1:2);
My = M(3:4,3:4);

CMx = [Mx(1,1)^2              -2*Mx(1,1)*Mx(1,2)             Mx(1,2)^2; ...
      -Mx(1,1)*Mx(2,1)  Mx(1,1)*Mx(2,2)+Mx(1,2)*Mx(2,1)  -Mx(1,2)*Mx(2,2); ...
      Mx(2,1)^2              -2*Mx(2,1)*Mx(2,2)             Mx(2,2)^2];

CMy = [My(1,1)^2              -2*My(1,1)*My(1,2)             My(1,2)^2; ...
      -My(1,1)*My(2,1)  My(1,1)*My(2,2)+My(1,2)*My(2,1)  -My(1,2)*My(2,2); ...
      My(2,1)^2              -2*My(2,1)*My(2,2)             My(2,2)^2];

CM = [  CMx    zeros(3);
      zeros(3)   CMy   ];